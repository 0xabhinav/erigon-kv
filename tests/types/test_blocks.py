import pytest

from erigon.types import decode_block

BLOCKS = {
    "berlin": {
        "number": 12244223,
        "hash": "0a72172a2bc7fa344a5e56276f0990f1f4344fbfb4d3fac8965fca3ff3e42aba",
        "rlp": "f90297f9020ba0d64563c8eeb32fbecd7c4954efbb4993a54bb77603fea27eec71a11d16cb66c4a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794bcc817f057950b0df41206c5d7125e6225cae18ea0c7773c8e1c0ccfdcb62a23b3ea9a0c0c5e596206e772ca67b700e960ea1a3efba071ad61c320d9151e650b48e1256de61f46a98e80f870f20912852aef7768d0a3a04542c63f6be5d8ba80d9a502140b45e06269446e6e6a6c405d1facb79a812673b90100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000040000000000000000000000000000000000080000000000000000000000000000000000000000000000000200000000000000000088000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000002000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000040000000000000000000008718454efc4bfa4c83bad4ff83bea41b83b17ea38460781a948a2f48756f42692f000024a0abea5bb8868bdaf77cf140c40e6c4cb52d2c1a18d7cd4b3ce862b464ea902999888845d703addfb57ff886f884118083bea41b940000000000004946c0e9f43f4dee607b0ef1fa1c80a4a0712d68000000000000000000000000000000000000000000000000000000000000014025a0f690c75e60cfad5061e208a3c1ecc0a8a4b86474d8f3f8ce468b7c56210a0878a0329ed5c7b65b8df5d08e0fa50543ccf9c64233dbb0495f5ff9c1875f7ee279b1c0",
    },
    "london": {
        "number": 12965255,
        "hash": "5ecc00a0db6cb91bd2937c9276713171acb1947c40e48a53500cf79d0aae2fb2",
        "rlp": "f90362f9021fa04059c6aa1daaea8ddb9b62d44cebd71f646439008962eebf77e8a02a54d52e12a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d4934794ea674fdde714fd979de3edf0f56aa9716b898ec8a080280f62e433f265a787498b5bb3d9c474c6a91a2fd1cecb27cf800710bb990ca0404d8817f0b7dd6675191f13180d6caa0f9c3a4b4b69dbc238a6ef54ed45fcfda04c369ace9a00b96a49c475506933558c76b635556c7106c01104e598f46d5574b9010000000000000000000000000000000000000000000000000000000000000800000000004000000000000000000000010000000000000000000000000000220000000080000000008000000008000000000000080000000200000000000000000000000000020000000100000000000800000000000001000000000010002000000000001000000010000000000000000000000004100000000000002000100000020000000000000000000080000000000000000000000000000010000008000000002002000000000000000002000000000000000000000000000000000020000010000000000000000000000000010000000000000100000000040000000020871b3cf2623712f983c5d5878401b0809383026e5d84610be8889765746865726d696e652d6575726f70652d6e6f72746831a0eba0827737362fd45d26caa097fa26fcf6bef1e72c69aa0c8c095a96569aa52a884697ac634558b2968510835bf3bbf9013cf8ad831b13358515a38de8798301492994dac17f958d2ee523a2206206994597c13d831ec780b844a9059cbb0000000000000000000000002a43bf51748ebc603f0544db6a3bd4f80292249200000000000000000000000000000000000000000000000000000002122eedc026a00ad147049aa73b49f597d0f245889094a6c59b5669160f3b29dca7b360d66899a052b1c2775512ccfa26d2020dec176e7570e8cc0eb0c9d2227993e908280cb51df88b820a298510ff239a0083017768947645eec8bb51862a5aa855c40971b2877dae81af80a4a0712d68000000000000000000000000000000000000000000000000000000000000000126a0dcff9e55927fb94b91abd3f09ea89b7967ad13e1891f3ee8e7b2812cdc9cee1fa03861fdabe15b9f34f2d3f055d92ae0eb01b8d257c630535d5ca4fe341969cfb8c0",
    },
    "istanbul": {
        "number": 9069005,
        "hash": "ecfdb646823522a6791a94f40fe11add6576ba510c999588e87ee51099fb1b03",
        "rlp": "f91c2ef9021aa0afd3073c0c2b4e56cd25d2cd674a85ea2eecb26ef25196171ad9de209c1c7ed4a01dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347945a0b54d5dc17e0aadc383d2db43b0a0d3e029c4ca08be29fc6ebead14e37a98777e6a32393e67bd212413355bdf9132a5e6d590c0ba00b8943b30fe311321e95b1cd3fdaf0f815d1bb57c1a5cd635451917feb8282b0a0b4cdc7f2d3212bb3b8a246f77c0fc6c98319cbd8be6b5cf92af1b8e40d3bb8bab9010000084803080000090041101000004292100001010020002014800050800a0400000002010000a2000008081200418000004000004800c001630080484203a2541020800040040041222400080040002020804003000202189883020190010100a10000a25002000402080000000040000008060e08682000000a201009241408000502d000080105009090401080f082204810004810080000c42010830900000c808212800000400008020100010121401400100000080002060008002600030100000240030800000070180248249008000a20802802000802c812d00000808100004908004121900080c020000404000141014120405620d100010212c40087091ae53a7b9029838a61cd8388d9e88331bfe0845dec4305995050594520737061726b706f6f6c2d6574682d636e2d687a33a09e54987a00758e5df89d5f4a2f0cba0689890f315fb415a306d79f4cc09da5e288e8f8842c1d3bd4baf91a0df91a0a4184bebc2000837a120094c6f101cd304b6b9a3eea355e796b4ee3aa8244a680b919a4ad8733ca000000000000000000000000ac08809df1048b82959d6251fbc9538920bed1fa00000000000000000000000000000000000000000000000000000000000000600000000000000000000000000000000000000000000000000000000000000d000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000503b47844ec7c6b5f4018a9426e4f1f720301fc1000000000000000000000000324016673af3c080ba4e6690c1a96b08706df3310000000000000000000000000910a3bab4d63780d37fdaf6ccfb74ebe731aa4c0000000000000000000000008f357682449b535f756ec3c19cfa8a56be7b2ef0000000000000000000000000d382c0a176d5062bbc7e4d40f46bdb1fcac9afbe000000000000000000000000957a48ed0f21d1a61e878ddd2a2f176c6ea82ba700000000000000000000000077d7d206138801931d78059ac39137ba4f268c1700000000000000000000000021696caf0e4356088d208e71b3fdc177f27beaa2000000000000000000000000685aa2fba05695dc57ed75840950bc953d5663ad00000000000000000000000011aec6f65da96e37014bceee187fda08110fd0940000000000000000000000003c83ae649d7162fff1f71dc86497b5a288b8e1e7000000000000000000000000e18b0f7ef9a2c7bc8755478cddd0d4d31d4e4ef000000000000000000000000058bbd37612c700e9d295ee486efe07600ca695d100000000000000000000000008c14281e4e59ed1b68e71204cd556cedb56b59d000000000000000000000000ce1ff86d9e05656fc397f86be088c609570dfc2300000000000000000000000088b7538d429f49ec594c70c5331fd708ce61fec9000000000000000000000000e14cb51b91178104a7dd6abe8c75960998fa2a360000000000000000000000006124ada9a5bd08a33d79083c5632c2a61bd43d6600000000000000000000000035555775caf9fc0aa6c093f25a5f31a7d5ea94e9000000000000000000000000741fbadc47d4019b9b8fcaab59d7f06ef18e64170000000000000000000000000934314a702123d95432a9877a7b3258d833af78000000000000000000000000bba182ee6142ba763704f5867056604162707e9a0000000000000000000000007efbdd2f773454720b86cda0011b37c215b85898000000000000000000000000f917ef7b087f151ad0d19edb39b83039a93d1c6d000000000000000000000000364688b88a98b5addf24446497aeee4228b07b1d000000000000000000000000c9499f7e1d03f0c08dc7632fa457396e9d20777d000000000000000000000000f9b58f70d2b1d2999fd3809b36cc672231adaffa0000000000000000000000000c028d05e66a6ef5892b98b0d98c40f551ba92910000000000000000000000001f6eb0c2e2f1a174bd99f9b079cbde928e7f784a000000000000000000000000714fc08351bc05736b3d1fb23c2989901b34328d0000000000000000000000005ce6838017a44be41b1072ccb0a0138b85e8be17000000000000000000000000bdc8edca6b6e6aa939737e294b1f64a168a895020000000000000000000000002367312e3e8aea92f05632272e79d62a0754a36c00000000000000000000000033e8fa484acb3fa50e5397d6cd4e0a65a1ac19b0000000000000000000000000845c6473cf4ab7a90d61b087b355be889af6e222000000000000000000000000c97f387ec39732a67b7642ec3a8f41c3894b262900000000000000000000000072531d5a788e1191a6b2741011460c0713b5fa48000000000000000000000000e9539c49f16968cdeaa8710a37ee790b0dea0b99000000000000000000000000f80c42a8599b4ab7a693f891d641b3803dee3415000000000000000000000000fb7e225b2ba5af2f8e1d263ec90c4c8045bbdb4900000000000000000000000014aeeec40b00c2d90ff905486f3ecaa61df7f449000000000000000000000000de550ba7ef32a7f4ed27f601498b1648e58678da000000000000000000000000f2f01a857e6b4ff9104df87cb247163f7ddfc5d9000000000000000000000000428b994a673254c612eef982a7247a3fb266f2030000000000000000000000008daa3f237cc253ec4a6861f3c61bc4fe593a15a8000000000000000000000000fa699c3d6c40ae8ee57dd793814f3b5094440857000000000000000000000000b028150050ad32f627f0c1ed565afc09f2bdc310000000000000000000000000bc14b89429ac197fdcc95762b5eeecef5f28225400000000000000000000000024b84bb9d8dfdd66474ea8ab818e964dec2cfc500000000000000000000000007fdafb94b34acb2d9f3a411523b8fdc3a18605e40000000000000000000000003833e0ed569d4f196d95ccf77f130f3f20af16d4000000000000000000000000196e7a8f25f5ba25f349aa3551b087349c5abe9e000000000000000000000000ae371f1941fbc0455dd213f3ae0f3bb9ef9514650000000000000000000000007e51552a1a064542e5475ee6f55b85b5dbd6876100000000000000000000000076c0ac0a255040b1e1367143a7f22375a2d46273000000000000000000000000d5a962bfc1d31a30cfcfd746f592faa04bf72ca9000000000000000000000000b4af5342b3dc7d7dc37d404748fdd2bc909bb7180000000000000000000000005b89a55870aab7f943796fcd5615b80a81d484b1000000000000000000000000292449f7b073d01e8b53871df76fb7f682b3b6d5000000000000000000000000262c2297896b6b3b6c2363ff6ad4f42b34727273000000000000000000000000b19ccfa99ba1399821fa07745e023bffa1a8f20c0000000000000000000000005dbceb9277a86b695b02761e0459602cb63ba69f0000000000000000000000004df02f6025991a7d03d5461d6e4b2709c9f9b0be000000000000000000000000f9bab714942391a9b22d619f18c9c406b9b899ea000000000000000000000000945e5f43f0f1c57c55e94f3c22657022c71b28ee00000000000000000000000088e63bc10c8411a76aa637eaabf11cee66ee9845000000000000000000000000ff10c675f3343d2171bfed5d021f024f84f58eb000000000000000000000000061bcc2dda672a7d5ccfb3206b9923e3ef1dd3bd5000000000000000000000000c64641fe6f6c0808d7898eb0571c267986b33520000000000000000000000000856b5da7ea834e606d432b53b855d00e4e2c932c000000000000000000000000fbc45282811950bcba4bda032e144b0e151296ed0000000000000000000000000964344d816601387826592ff1241cc4dbdacfd900000000000000000000000004d24176c949157f3d136eaba10b8612610ae1320000000000000000000000002f14334f89278e0fd4dd85e2828c01ada0fc6838000000000000000000000000c9cc9cff89dd62ca82b0a711c9c6f491df048e05000000000000000000000000b94606c90fd1d6c9f76d34f30c2144d4ea6357390000000000000000000000008d7cc3fdc4532f59491ed21f82a8d6dbdab77df3000000000000000000000000cc4d7ea378c90393e150e19218800b516782e136000000000000000000000000a6f74dbca6ee14518ad020a9356d823e2aeab7e6000000000000000000000000660d7921f5545fff66b593c3985c190ae2619d59000000000000000000000000c0ca894a00c90209c338db2b2aecf162c371c88e0000000000000000000000004ac5b773a4af09a84dbf8f037a3ef4fc8e76dbd600000000000000000000000082b214fb9f8a0a4f98620ea98056df7b6135a248000000000000000000000000427ba9e771d36f9d6f015dfdb7b3acc1486d71b6000000000000000000000000bf20e1ab67407d93819faeb665e059763165edcf000000000000000000000000cebc3e4e64c7f075efd27f6cce5dd5490c7e572f0000000000000000000000008086001da9064f5c82cefffe9c2ff2448d06281e000000000000000000000000a7d2b80d8e6285d5567913e5b962935111193a05000000000000000000000000c068f8cc0c680f1d0cfd426c83ea473c77fb249900000000000000000000000067a8fa016a4d39963d8e828ae23ebc01ac0088c8000000000000000000000000869919a68af0e203cdde15b427d0becdb0519e85000000000000000000000000bdb8f5ddfbde3d7e0ef3d5dd02548e5fa5f40906000000000000000000000000a75e5b16c9de7df276fd48fb033daea02c00a6ca0000000000000000000000000af768306bef7333d72009b3c7ff1ddbcdb2a397000000000000000000000000167d57fb2410a451db8e8226f03802ddd4ab60f9000000000000000000000000f67e4681143c52588d1b4f8c296c0e6b2d4fe18a0000000000000000000000003faec9fffb893deb050d25272faab048bb8b99c7000000000000000000000000e0a07fe1929ff7aa1fe6f7f210616cdb56107fcf0000000000000000000000001477f4187d48252cc05e8318f47fcaa4e874a08800000000000000000000000044f7599201a4f8818eace0bb247723e75e7ac0d50000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000ca900a7c00000000000000000000000000000000000000000000000000000000c1f2ab4a0000000000000000000000000000000000000000000000000000000074763e4a0000000000000000000000000000000000000000000000000000000090ba3f4800000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074704869000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000749a019000000000000000000000000000000000000000000000000000000000782feaea00000000000000000000000000000000000000000000000000000000782feaea00000000000000000000000000000000000000000000000000000000855d8a600000000000000000000000000000000000000000000000000000000074c3bab700000000000000000000000000000000000000000000000000000000758276d70000000000000000000000000000000000000000000000000000000074f95fa00000000000000000000000000000000000000000000000000000000074b7cef5000000000000000000000000000000000000000000000000000000007dba82180000000000000000000000000000000000000000000000000000000075172d0500000000000000000000000000000000000000000000000000000000757c80f60000000000000000000000000000000000000000000000000000000074763e4a00000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074db923b0000000000000000000000000000000000000000000000000000000074704869000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074c3bab7000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000d63445f00000000000000000000000000000000000000000000000000000000077f4502000000000000000000000000000000000000000000000000000000000791e56120000000000000000000000000000000000000000000000000000000078a12a9d0000000000000000000000000000000000000000000000000000000074704869000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000077c4a1180000000000000000000000000000000000000000000000000000000074763e4a0000000000000000000000000000000000000000000000000000000074763e4a000000000000000000000000000000000000000000000000000000008403d566000000000000000000000000000000000000000000000000000000008403d566000000000000000000000000000000000000000000000000000000008cdccf6200000000000000000000000000000000000000000000000000000000ae9f7bcc00000000000000000000000000000000000000000000000000000000ae9f7bcc000000000000000000000000000000000000000000000000000000008403d56600000000000000000000000000000000000000000000000000000000ae9f7bcc00000000000000000000000000000000000000000000000000000000ae9f7bcc000000000000000000000000000000000000000000000000000000008403d566000000000000000000000000000000000000000000000000000000008421a2cb00000000000000000000000000000000000000000000000000000000ad45c6d200000000000000000000000000000000000000000000000000000000afc981be0000000000000000000000000000000000000000000000000000000074704869000000000000000000000000000000000000000000000000000000007dba821800000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074b7cef50000000000000000000000000000000000000000000000000000000074b7cef50000000000000000000000000000000000000000000000000000000074c3bab70000000000000000000000000000000000000000000000000000000074763e4a00000000000000000000000000000000000000000000000000000000bef7baca00000000000000000000000000000000000000000000000000000000d18c2e28000000000000000000000000000000000000000000000000000000007dba821800000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074763e4a000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074763e4a000000000000000000000000000000000000000000000000000000007605982d000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000747048690000000000000000000000000000000000000000000000000000000074c9b0980000000000000000000000000000000000000000000000000000000074c9b0980000000000000000000000000000000000000000000000000000000074b7cef50000000000000000000000000000000000000000000000000000000074b7cef5000000000000000000000000000000000000000000000000000000007dba8218000000000000000000000000000000000000000000000000000000008403d56600000000000000000000000000000000000000000000000000000000e8d4a51000000000000000000000000000000000000000000000000000000000a0f4b0e1000000000000000000000000000000000000000000000000000000008bb2c97000000000000000000000000000000000000000000000000000000000ba43b74000000000000000000000000000000000000000000000000000000000ca900a7c000000000000000000000000000000000000000000000000000000008f30db460000000000000000000000000000000000000000000000000000000074c3bab7000000000000000000000000000000000000000000000000000000008bb2c970000000000000000000000000000000000000000000000000000000008bb2c97000000000000000000000000000000000000000000000000000000000ca900a7c00000000000000000000000000000000000000000000000000000000ca900a7c000000000000000000000000000000000000000000000000000000009532a80800000000000000000000000000000000000000000000000000000000ca900a7c0000000000000000000000000000000000000000000000000000000074704869000000000000000000000000000000000000000000000000000000007470486900000000000000000000000000000000000000000000000000000000d63445f000000000000000000000000000000000000000000000000000000000ca900a7c0000000000000000000000000000000000000000000000000000000074cfa67900000000000000000000000000000000000000000000000000000000ca900a7c000000000000000000000000000000000000000000000000000000008f30db46000000000000000000000000000000000000000000000000000000008bb2c97000000000000000000000000000000000000000000000000000000000969848c400000000000000000000000000000000000000000000000000000000ca900a7c00000000000000000000000000000000000000000000000000000000e680992c000000000000000000000000000000000000000000000000000000008f0d1800000000000000000000000000000000000000000000000000000000008403d56600000000000000000000000000000000000000000000000000000000ae9f7bcc00000000000000000000000000000000000000000000000000000000ae9f7bcc001ca00d2d10e77fd7e632a62f1db08b25e72ac96cd67a94ee98e226a3813b9e00418ea033ab4a735ffa458827431ac4df3871459b80d1ce1e9d9ddc9586120a1ce389abc0",
    },
}


@pytest.mark.parametrize("name", BLOCKS)
def test_decode_block(name):
    block = decode_block(bytes.fromhex(BLOCKS[name]["rlp"]))
    print(type(block))
    assert block.number == BLOCKS[name]["number"]
    assert block.hash == bytes.fromhex(BLOCKS[name]["hash"])
